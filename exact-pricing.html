<title>Enterprise Rate Manager - Exact Pricing</title>
<link rel="stylesheet" href="css/exact-styles.css">
</head>

<body>

    <!-- SIDEBAR -->
    <div class="sidebar">
        <div class="brand">
            <span>Rate</span>Manager <span style="font-size:10px; opacity:0.6; margin-left:4px;">(Exact)</span>
        </div>
        <nav class="nav">
            <div class="nav-item active" onclick="switchView('dashboard', this)">
                <span class="nav-icon">üìä</span> Overview
            </div>
            <div class="nav-item" onclick="switchView('rooms', this)">
                <span class="nav-icon">üè®</span> Room Types
            </div>
            <div class="nav-item" onclick="switchView('rates', this)">
                <span class="nav-icon">üè∑Ô∏è</span> Rate Plans
            </div>
            <div class="nav-item" onclick="switchView('levels', this)">
                <span class="nav-icon">üìä</span> Rate Levels
            </div>
            <div class="nav-item" onclick="switchView('matrix', this)">
                <span class="nav-icon">üìÖ</span> Rates Grid (Matrix)
            </div>
        </nav>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main">
        <div class="top-bar">
            <div class="page-title" id="pageTitle">Overview (Exact Pricing)</div>
            <div>
                <a href="index.html" class="btn btn-outline">Switch to Standard Model</a>
                <button class="btn btn-outline" style="margin-left:12px;">My Hotel (Demo)</button>
            </div>
        </div>

        <div class="content-scroll">

            <!-- DASHBOARD VIEW -->
            <div id="view-dashboard" class="view-section active">
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Active Room Types</h3>
                        <div class="value" id="stat-rooms">Loading...</div>
                    </div>
                    <div class="stat-card">
                        <h3>Rate Plans</h3>
                        <div class="value" id="stat-plans">Loading...</div>
                    </div>
                    <div class="stat-card">
                        <h3>Distribution Channels</h3>
                        <div class="value">3 Connected</div>
                    </div>
                    <div class="stat-card">
                        <h3>System Status</h3>
                        <div class="value" style="color:var(--success);">Online</div>
                    </div>
                </div>

                <div
                    style="margin-top:32px; padding:24px; background:white; border-radius:12px; border:1px solid var(--border);">
                    <h2 style="margin-bottom:16px;">Welcome to Exact Pricing Mode</h2>
                    <p style="color:var(--text-muted); line-height:1.6;">
                        This interface allows you to set <strong>exact, fixed prices</strong> for every room type and
                        date.<br>
                        Unlike the standard model, there are no formulas or anchor derivations. What you see is exactly
                        what is sent to the channel manager.
                    </p>
                </div>
            </div>

            <!-- ROOMS VIEW -->
            <div id="view-rooms" class="view-section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Room Types</div>
                        <button class="btn btn-primary" onclick="openRoomModal()">+ Add Room Type</button>
                    </div>
                    <table class="table" id="roomsTable">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Cluster</th>
                                <th>Name</th>
                                <th>Inventory</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="roomsTableBody">
                            <!-- JS Populated -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- RATES VIEW -->
            <div id="view-rates" class="view-section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Rate Plans</div>
                        <button class="btn btn-primary" onclick="openRateModal()">+ Add Rate Plan</button>
                    </div>
                    <table class="table" id="ratesTable">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Model</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ratesTableBody">
                            <!-- JS Populated -->
                        </tbody>
                    </table>
                </div>

                <!-- Rate Config Matrix -->
                <div class="card" style="margin-top:24px; overflow-x:auto;">
                    <div class="card-header">
                        <div class="card-title">Base Price Configuration</div>
                        <div style="font-size:12px; opacity:0.7;">Set the default (base) price for each room type per
                            rate plan.</div>
                    </div>
                    <table class="table" id="suppMatrixTable"> <!-- reusing ID for simplicity -->
                        <thead id="suppMatrixHead"></thead>
                        <tbody id="suppMatrixBody"></tbody>
                    </table>
                </div>
            </div>

            <!-- RATE LEVELS VIEW -->
            <div id="view-levels" class="view-section">
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">Rate Levels (Exact Pricing)</div>
                        <div style="font-size:12px; opacity:0.7;">Define fixed price points for all room types.</div>
                    </div>
                    <div style="padding:16px;">
                        <button class="btn btn-primary" style="margin-bottom:16px;" onclick="addRateLevel()">+ Add
                            Level</button>
                        <div style="overflow-x:auto;">
                            <table class="table" id="levelsGrid">
                                <thead id="levelsGridHead">
                                    <!-- Dynamic Columns: Level Name | Room 1 | Room 2 ... | Actions -->
                                </thead>
                                <tbody id="levelsGridBody">
                                    <!-- JS Populated -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- VIEW: MATRIX -->
            <div id="view-matrix" class="view-section">
                <div class="card" style="overflow-x:auto;">
                    <div class="card-header">
                        <div class="card-title">Daily Rates Matrix (Simulation)</div>
                        <div>
                            <label style="font-size:13px; color:var(--text-muted); margin-right:8px;">Global Base
                                Rate:</label>
                            <input type="number" id="globalBaseInput" value="100" class="matrix-input"
                                oninput="updateGlobalBase(this.value)">
                        </div>
                    </div>
                    <div style="overflow-x:auto;">
                        <table id="matrixVisualTable">
                            <thead>
                                <tr id="matrixThead"></tr>
                            </thead>
                            <tbody id="matrixTbody"></tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- MODALS -->

    <!-- Room Modal -->
    <div id="roomModal" class="modal-overlay">
        <div class="modal">
            <div class="card-header">
                <div class="card-title">Add/Edit Room Type</div>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Cluster Group</label>
                    <select id="m_room_cluster" class="form-select">
                        <!-- Populated by JS -->
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Room Name</label>
                    <input type="text" id="m_room_name" class="form-input" placeholder="e.g. Deluxe Suite">
                </div>
                <div class="form-group">
                    <label class="form-label">Room Code</label>
                    <input type="text" id="m_room_code" class="form-input" placeholder="e.g. DLX">
                </div>
                <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:24px;">
                    <button class="btn btn-outline" onclick="closeModal('roomModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="saveRoom()">Save Room</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Rate Plan Modal -->
    <div id="rateModal" class="modal-overlay">
        <div class="modal">
            <div class="card-header">
                <div class="card-title">Add/Edit Rate Plan</div>
            </div>
            <div class="modal-body">
                <input type="hidden" id="m_rate_id">
                <div class="form-group">
                    <label class="form-label">Plan Name</label>
                    <input type="text" id="m_rate_name" class="form-input" placeholder="e.g. Non-Refundable">
                </div>
                <div class="form-group">
                    <label class="form-label">Plan Code</label>
                    <input type="text" id="m_rate_code" class="form-input" placeholder="e.g. NREF">
                </div>

                <div class="form-group">
                    <label class="form-label">Structure Type</label>
                    <select id="m_rate_type" class="form-select" onchange="toggleDerivationFields()">
                        <option value="source">Independent Data Source (Base)</option>
                        <option value="derived">Derived Plan</option>
                    </select>
                </div>

                <div id="derivationOptions"
                    style="display:none; background:#f8fafc; padding:16px; border-radius:8px; border:1px solid var(--border);">
                    <div class="form-group">
                        <label class="form-label">Parent Plan</label>
                        <select id="m_rate_parent" class="form-select"></select>
                    </div>
                    <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
                        <div class="form-group">
                            <label class="form-label">Rule</label>
                            <select id="m_rate_rule" class="form-select">
                                <option value="percent">Percentage (%)</option>
                                <option value="fixed">Fixed Amount ($)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Value</label>
                            <input type="number" id="m_rate_val" class="form-input" value="-10">
                        </div>
                    </div>
                </div>

                <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:24px;">
                    <button class="btn btn-outline" onclick="closeModal('rateModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="saveRate()">Save Rate Plan</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ROOM SUPPLEMENT MODAL -->
    <div id="suppModal" class="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h3>Rate Supplements</h3>
                <button class="btn btn-outline" onclick="closeModal('suppModal')">‚úï</button>
            </div>
            <div class="modal-body">
                <input type="hidden" id="m_supp_rate_id">
                <p style="color:#64748b; font-size:13px; margin-bottom:16px;">
                    Override the default room supplements for this specific Rate Plan. Leave blank to use the room's
                    default.
                </p>

                <table style="width:100%; border-collapse:collapse; font-size:13px;">
                    <thead>
                        <tr style="text-align:left; border-bottom:1px solid #e2e8f0;">
                            <th style="padding:8px;">Room Type</th>
                            <th style="padding:8px;">Default Supp.</th>
                            <th style="padding:8px; width:120px;">Override ($)</th>
                        </tr>
                    </thead>
                    <tbody id="suppTableBody">
                    </tbody>
                </table>

                <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:24px;">
                    <button class="btn btn-outline" onclick="closeModal('suppModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="saveSupplements()">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/store.js"></script>
    <script src="js/exact-pricing.js"></script>
    <script>
        // Start App
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>

</html>